<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="mercury-mass-in-atmosphere">Mercury mass in atmosphere</h1>
<p>Martin Colomb 2025-08-26</p>
<h1 id="chargement-des-packages">Chargement des packages</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(writexl)</span></code></pre></div>
<h1 id="lecture-des-données">Lecture des données</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>chem_hist_B100<span class="ot">&lt;-</span><span class="st">&quot;C:/Users/colom/Desktop/STAGE/data/clean_mod_data/14_3_1/HIST_B100&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>chem_hist<span class="ot">&lt;-</span><span class="st">&quot;C:/Users/colom/Desktop/STAGE/data/clean_mod_data/14_3_1&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>con_hg_B100<span class="ot">&lt;-</span><span class="fu">nc_open</span>(<span class="fu">file.path</span>(chem_hist_B100, <span class="st">&quot;GEOSChem.SpeciesConc.2015_m.nc4&quot;</span>))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>statemet_B100<span class="ot">&lt;-</span><span class="fu">nc_open</span>(<span class="fu">file.path</span>(chem_hist_B100, <span class="st">&quot;GEOSChem.StateMet.2015_m.nc4&quot;</span>))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>area<span class="ot">&lt;-</span><span class="fu">ncvar_get</span>(con_hg_B100, <span class="st">&quot;AREA&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>conc_hg0<span class="ot">&lt;-</span><span class="fu">ncvar_get</span>(con_hg_B100, <span class="st">&quot;SpeciesConcVV_Hg0&quot;</span>) <span class="co">#Concentration of species Hg0 (mol mol-1 dry)</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>Met_AD<span class="ot">&lt;-</span><span class="fu">ncvar_get</span>(statemet_B100, <span class="st">&quot;Met_AD&quot;</span>)  <span class="co">#Met_AD (Dry air mass kg)</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>area<span class="ot">&lt;-</span><span class="fu">ncvar_get</span>(con_hg_B100, <span class="st">&quot;AREA&quot;</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>M_Hg <span class="ot">&lt;-</span> <span class="fl">0.20059</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>M_air <span class="ot">&lt;-</span> <span class="fl">0.028964</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>kg_Mg  <span class="ot">&lt;-</span> <span class="fl">1e-3</span>     <span class="co"># conversion en tonnes</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>avo <span class="ot">=</span> <span class="fl">6.02e23</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>s_in_yr <span class="ot">&lt;-</span> <span class="dv">365</span> <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>  <span class="co"># seconds in a year</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>unit_conv_dd <span class="ot">=</span> M_Hg <span class="sc">/</span> avo <span class="sc">*</span> kg_Mg <span class="sc">*</span> cm2_m2 <span class="sc">*</span> s_in_yr <span class="sc">*</span> area</span></code></pre></div>
<h1 id="the-conversion-formula-is">The conversion formula is:</h1>
<pre><code>    mol species                g/mol species
    ----------- * kg dry air * -------------
    mol dry air                g/mol dry air

    = volume mixing ratio * dry air mass * MW species / MW dry air

    = kg species
    
        
    MW dry air is defined as 28.9644 g/mol
    https://github.com/geoschem/geos-chem/blob/4722f288e90291ba904222f4bbe4fc216d17c34a/Headers/physconstants.F90#L26</code></pre>
<h1 id="calcul-de-la-masse-de-mercure-dans-latmosphère-sur-lannée">Calcul de
la masse de mercure dans l’atmosphère sur l’année</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Moyenne temporelle sur les 12 mois</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>mean_conc_hg0 <span class="ot">&lt;-</span> <span class="fu">apply</span>(conc_hg0, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>mean_Met_AD <span class="ot">&lt;-</span> <span class="fu">apply</span>(Met_AD, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># Calcul de la masse de Hg (en kg) dans chaque maille</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>mass_hg <span class="ot">&lt;-</span> mean_conc_hg0 <span class="sc">*</span> mean_Met_AD <span class="sc">*</span> (M_Hg <span class="sc">/</span> M_air)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># Masse totale de Hg dans toute l&#39;atmosphère (somme de toutes les mailles)</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>total_mass_hg <span class="ot">&lt;-</span> <span class="fu">sum</span>(mass_hg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># en kg</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>total_mass_hg_tonnes <span class="ot">&lt;-</span> total_mass_hg <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">print</span>(total_mass_hg_tonnes)</span></code></pre></div>
<pre><code>## [1] 3757.912</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(chem_hist, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> subdirs[<span class="fu">grepl</span>(<span class="st">&quot;HIST_&quot;</span>, <span class="fu">basename</span>(subdirs))]</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Résultat</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>results_mass_Hg0 <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="cf">for</span> (subdir <span class="cf">in</span> subdirs) {</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(subdir, <span class="st">&quot;GEOSChem.SpeciesConc.2015_m.nc4&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="cf">next</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(file_path)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  </span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="co"># Concentration de Hg0</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  conc_hg0 <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc, <span class="st">&quot;SpeciesConcVV_Hg0&quot;</span>)  <span class="co"># [mol/mol]</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">nc_close</span>(nc)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  </span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  <span class="co"># Moyenne temporelle sur les 12 mois</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  mean_conc_hg0 <span class="ot">&lt;-</span> <span class="fu">apply</span>(conc_hg0, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  </span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  <span class="co"># Masse (kg) avec mean_Met_AD déjà disponible</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  mass_hg0 <span class="ot">&lt;-</span> mean_conc_hg0 <span class="sc">*</span> mean_Met_AD <span class="sc">*</span> (M_Hg <span class="sc">/</span> M_air)</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  total_mass_hg0_tonnes <span class="ot">&lt;-</span> <span class="fu">sum</span>(mass_hg0, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  </span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  results_mass_Hg0 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_mass_Hg0, <span class="fu">tibble</span>(</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>    <span class="at">case =</span> <span class="fu">basename</span>(subdir),</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>    <span class="at">total_Hg0_mass_tonnes =</span> total_mass_hg0_tonnes</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  ))</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>}</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co"># Résultat final</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="fu">print</span>(results_mass_Hg0)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    case          total_Hg0_mass_tonnes
##    &lt;chr&gt;                         &lt;dbl&gt;
##  1 HIST_B10                      3637.
##  2 HIST_B100                     3758.
##  3 HIST_B150                     3798.
##  4 HIST_B20                      3656.
##  5 HIST_B200                     3828.
##  6 HIST_B30                      3673.
##  7 HIST_B40                      3688.
##  8 HIST_Feinberg                 4469.
##  9 HIST_V3                       3616.
## 10 HIST_V4                       3616.</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(chem_hist, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> subdirs[<span class="fu">grepl</span>(<span class="st">&quot;HIST_&quot;</span>, <span class="fu">basename</span>(subdirs))]</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>results_mass_Hg_total <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="cf">for</span> (subdir <span class="cf">in</span> subdirs) {</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(subdir, <span class="st">&quot;GEOSChem.SpeciesConc.2015_m.nc4&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="cf">next</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(file_path)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  <span class="co"># Récupérer tous les noms de variables contenant &quot;Hg&quot;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  hg_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(nc<span class="sc">$</span>var)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  hg_vars <span class="ot">&lt;-</span> hg_vars[<span class="fu">grepl</span>(<span class="st">&quot;Hg&quot;</span>, hg_vars)]</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  </span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>  <span class="co"># Initialiser la somme avec la première variable Hg</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>  Hg_total <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc, hg_vars[<span class="dv">1</span>])</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  </span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="co"># Ajouter les autres variables Hg</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(hg_vars) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>    <span class="cf">for</span> (varname <span class="cf">in</span> hg_vars[<span class="sc">-</span><span class="dv">1</span>]) {</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>      Hg_total <span class="ot">&lt;-</span> Hg_total <span class="sc">+</span> <span class="fu">ncvar_get</span>(nc, varname)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>    }</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  }</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  </span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>  <span class="fu">nc_close</span>(nc)</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>  </span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>  <span class="co"># Moyenne temporelle sur les 12 mois</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>  mean_Hg_total <span class="ot">&lt;-</span> <span class="fu">apply</span>(Hg_total, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>  </span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>  <span class="co"># Calcul de la masse (kg) avec mean_Met_AD déjà disponible</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>  mass_Hg_total <span class="ot">&lt;-</span> mean_Hg_total <span class="sc">*</span> mean_Met_AD <span class="sc">*</span> (M_Hg <span class="sc">/</span> M_air)</span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>  total_mass_Hg_tonnes <span class="ot">&lt;-</span> <span class="fu">sum</span>(mass_Hg_total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>  </span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a>  results_mass_Hg_total <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_mass_Hg_total, <span class="fu">tibble</span>(</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a>    <span class="at">case =</span> <span class="fu">basename</span>(subdir),</span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a>    <span class="at">total_Hg_mass_tonnes =</span> total_mass_Hg_tonnes</span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a>  ))</span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a>}</span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="fu">print</span>(results_mass_Hg_total)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    case          total_Hg_mass_tonnes
##    &lt;chr&gt;                        &lt;dbl&gt;
##  1 HIST_B10                     3767.
##  2 HIST_B100                    3882.
##  3 HIST_B150                    3920.
##  4 HIST_B20                     3785.
##  5 HIST_B200                    3950.
##  6 HIST_B30                     3801.
##  7 HIST_B40                     3815.
##  8 HIST_Feinberg                4627.
##  9 HIST_V3                      3747.
## 10 HIST_V4                      3747.</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>state_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(chem_hist_B100, <span class="at">pattern =</span> <span class="st">&quot;GEOSChem.StateMet.*</span><span class="sc">\\</span><span class="st">.nc4$&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>chem_files  <span class="ot">&lt;-</span> <span class="fu">list.files</span>(chem_hist_B100, <span class="at">pattern =</span> <span class="st">&quot;GEOSChem.SpeciesConc.*</span><span class="sc">\\</span><span class="st">.nc4$&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># Supprimer les fichiers de moyenne annuelle que l&#39;on ne veut pas traiter</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>exclude_states <span class="ot">&lt;-</span> <span class="st">&quot;GEOSChem.StateMet.2015_m.nc4&quot;</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>exclude_chems  <span class="ot">&lt;-</span> <span class="st">&quot;GEOSChem.SpeciesConc.2015_m.nc4&quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>state_files <span class="ot">&lt;-</span> state_files[<span class="sc">!</span><span class="fu">basename</span>(state_files) <span class="sc">%in%</span> exclude_states]</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>chem_files  <span class="ot">&lt;-</span> chem_files[<span class="sc">!</span><span class="fu">basename</span>(chem_files) <span class="sc">%in%</span> exclude_chems]</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>masses_tonnes <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(state_files)) {</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  <span class="co"># Ouvrir fichiers</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>  nc_statemet <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(state_files[i])</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  nc_chem     <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(chem_files[i])</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>  <span class="co"># Lire les variables</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>  Met_AD    <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_statemet, <span class="st">&quot;Met_AD&quot;</span>)            <span class="co"># kg</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>  conc_hg0  <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_chem,     <span class="st">&quot;SpeciesConcVV_Hg0&quot;</span>) <span class="co"># mol/mol</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  <span class="co"># Calcul masse</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>  mass_hg <span class="ot">&lt;-</span> conc_hg0 <span class="sc">*</span> Met_AD <span class="sc">*</span> (M_Hg <span class="sc">/</span> M_air)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>  total_mass_kg <span class="ot">&lt;-</span> <span class="fu">sum</span>(mass_hg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>  total_mass_tonnes <span class="ot">&lt;-</span> total_mass_kg <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>  <span class="co"># Extraire la date depuis le nom de fichier</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>  file_date <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(<span class="fu">basename</span>(state_files[i]), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{8}&quot;</span>)</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>  file_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(file_date, <span class="at">format =</span> <span class="st">&quot;%Y%m%d&quot;</span>)</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>  <span class="co"># Stocker résultats</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>  dates <span class="ot">&lt;-</span> <span class="fu">c</span>(dates, file_date)</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>  masses_tonnes <span class="ot">&lt;-</span> <span class="fu">c</span>(masses_tonnes, total_mass_tonnes)</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>  <span class="co"># Fermer fichiers</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>  <span class="fu">nc_close</span>(nc_statemet)</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>  <span class="fu">nc_close</span>(nc_chem)</span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a>}</span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>df_mass <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(dates),  <span class="co"># forcer ici</span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a>  <span class="at">mass_tonnes =</span> masses_tonnes</span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a>)</span></code></pre></div>
<h1 id="plot-de-la-masse-totale-de-hg⁰-tonnes-par-mois">PLOT DE LA MASSE
TOTALE DE Hg⁰ (tonnes) PAR MOIS</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_mass, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> mass_tonnes)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a> <span class="co">#geom_line(color = &quot;steelblue&quot;, size = 1.2) +</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Évolution mensuelle de la masse de Hg⁰ dans l’atmosphère&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Masse totale de Hg⁰ (tonnes)&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2014-06-01&quot;</span>), <span class="at">y =</span> <span class="dv">3500</span>, <span class="at">label =</span> <span class="st">&quot;Spinup&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;2 months&quot;</span>,</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%Y-%m&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>)</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  )</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">print</span>(df_mass)</span></code></pre></div>
<pre><code>## # A tibble: 24 × 2
##    date       mass_tonnes
##    &lt;date&gt;           &lt;dbl&gt;
##  1 2014-01-01        325.
##  2 2014-02-01        850.
##  3 2014-03-01       1290.
##  4 2014-04-01       1683.
##  5 2014-05-01       2027.
##  6 2014-06-01       2346.
##  7 2014-07-01       2613.
##  8 2014-08-01       2836.
##  9 2014-09-01       2990.
## 10 2014-10-01       3114.
## # ℹ 14 more rows</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df_2015 <span class="ot">&lt;-</span> df_mass[<span class="fu">format</span>(df_mass<span class="sc">$</span>date, <span class="st">&quot;%Y&quot;</span>) <span class="sc">==</span> <span class="st">&quot;2015&quot;</span>, ]</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">print</span>(df_2015)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 2
##    date       mass_tonnes
##    &lt;date&gt;           &lt;dbl&gt;
##  1 2015-01-01       3444.
##  2 2015-02-01       3539.
##  3 2015-03-01       3615.
##  4 2015-04-01       3685.
##  5 2015-05-01       3768.
##  6 2015-06-01       3833.
##  7 2015-07-01       3857.
##  8 2015-08-01       3866.
##  9 2015-09-01       3860.
## 10 2015-10-01       3861.
## 11 2015-11-01       3865.
## 12 2015-12-01       3903.</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>mean_begin_2015 <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_2015<span class="sc">$</span>mass_tonnes[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>mean_end_2015 <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_2015<span class="sc">$</span>mass_tonnes[<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>mean_2015 <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_2015<span class="sc">$</span>mass_tonnes)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Moyenne janvier–juin 2015 :&quot;</span>, <span class="fu">round</span>(mean_begin_2015, <span class="dv">2</span>), <span class="st">&quot;tonnes&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Moyenne janvier–juin 2015 : 3647.51 tonnes&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Moyenne juillet–décembre 2015 :&quot;</span>, <span class="fu">round</span>(mean_end_2015, <span class="dv">2</span>), <span class="st">&quot;tonnes&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Moyenne juillet–décembre 2015 : 3868.43 tonnes&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Moyenne annuelle 2015 :&quot;</span>, <span class="fu">round</span>(mean_2015, <span class="dv">2</span>), <span class="st">&quot;tonnes&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Moyenne annuelle 2015 : 3757.97 tonnes&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Dossier principal</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>chem_hist <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/colom/Desktop/STAGE/data/clean_mod_data/14_3_1&quot;</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># Lister les sous-dossiers HIST_*</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(chem_hist, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> subdirs[<span class="fu">grepl</span>(<span class="st">&quot;HIST_&quot;</span>, <span class="fu">basename</span>(subdirs))]</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co"># Initialiser un tableau pour stocker les résultats</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="cf">for</span> (subdir <span class="cf">in</span> subdirs) {</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(subdir, <span class="st">&quot;HEMCO_diagnostic_2015_m.nc4&quot;</span>)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>  </span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="cf">next</span>  <span class="co"># skip si fichier manquant</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  </span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>  hemco_diagn <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(file_path)</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>  </span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>  <span class="co"># Extraire temps et poids mensuels</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>  time_raw <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(hemco_diagn, <span class="st">&quot;time&quot;</span>)</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>  origin_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-01-01 00:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>  time <span class="ot">&lt;-</span> origin_time <span class="sc">+</span> time_raw <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">days_in_month</span>(time) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">days_in_month</span>(time))</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>  </span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>  <span class="co"># Fonction de moyenne pondérée</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>  weighted_avg <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> weights)</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>  </span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>  <span class="co"># Aire des cellules</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>  area <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(hemco_diagn, <span class="st">&quot;AREA&quot;</span>)  <span class="co"># en m²</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a>  <span class="co"># Liste des variables d&#39;intérêt</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a>  vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a>    <span class="at">biomass      =</span> <span class="st">&quot;EmisHg0_BioBurn&quot;</span>,</span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a>    <span class="at">hg0_anthro   =</span> <span class="st">&quot;EmisHg0_Anthro&quot;</span>,</span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a>    <span class="at">hg2_anthro   =</span> <span class="st">&quot;EmisHg2ClP_Anthro&quot;</span>,</span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a>    <span class="at">hgp_anthro   =</span> <span class="st">&quot;EmisHgCl2_Anthro&quot;</span>,</span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a>    <span class="at">geo          =</span> <span class="st">&quot;EmisHg0_Natural&quot;</span>,</span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a>    <span class="at">asgm         =</span> <span class="st">&quot;EmisHg0_ASGM&quot;</span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a>  )</span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a>  </span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a>  <span class="co"># Stockage temporaire</span></span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a>  row <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">case =</span> <span class="fu">basename</span>(subdir))</span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a>  </span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a>  <span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(vars)) {</span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a>    varname <span class="ot">&lt;-</span> vars[[name]]</span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a>    emis <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(hemco_diagn, varname)  <span class="co"># [lon, lat, time]</span></span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a>    emis_avg <span class="ot">&lt;-</span> <span class="fu">apply</span>(emis, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), weighted_avg)</span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a>    total <span class="ot">&lt;-</span> <span class="fu">sum</span>(emis_avg <span class="sc">*</span> area <span class="sc">*</span> s_in_yr <span class="sc">*</span> kg_Mg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a>    row[[name]] <span class="ot">&lt;-</span> total</span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a>  }</span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a>  </span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a>  <span class="co"># Ajouter les calculs additionnels</span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a>  row<span class="sc">$</span>total_hg0      <span class="ot">&lt;-</span> row<span class="sc">$</span>hg0_anthro <span class="sc">+</span> row<span class="sc">$</span>asgm</span>
<span id="cb22-53"><a href="#cb22-53" tabindex="-1"></a>  row<span class="sc">$</span>total_hg2_hgp  <span class="ot">&lt;-</span> row<span class="sc">$</span>hg2_anthro <span class="sc">+</span> row<span class="sc">$</span>hgp_anthro</span>
<span id="cb22-54"><a href="#cb22-54" tabindex="-1"></a>  </span>
<span id="cb22-55"><a href="#cb22-55" tabindex="-1"></a>  <span class="co"># Ajouter au tableau final</span></span>
<span id="cb22-56"><a href="#cb22-56" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results, <span class="fu">as_tibble</span>(row))</span>
<span id="cb22-57"><a href="#cb22-57" tabindex="-1"></a>  </span>
<span id="cb22-58"><a href="#cb22-58" tabindex="-1"></a>  <span class="fu">nc_close</span>(hemco_diagn)</span>
<span id="cb22-59"><a href="#cb22-59" tabindex="-1"></a>}</span>
<span id="cb22-60"><a href="#cb22-60" tabindex="-1"></a></span>
<span id="cb22-61"><a href="#cb22-61" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 9
##   case          biomass hg0_anthro hg2_anthro hgp_anthro   geo  asgm total_hg0 total_hg2_hgp
##   &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
## 1 HIST_B10         275.       987.       89.2       310.  250.  838.     1825.          399.
## 2 HIST_B100        275.       987.       89.2       310.  250.  838.     1825.          399.
## 3 HIST_B150        275.       987.       89.2       310.  250.  838.     1825.          399.
## 4 HIST_B20         275.       987.       89.2       310.  250.  838.     1825.          399.
## 5 HIST_B200        275.       987.       89.2       310.  250.  838.     1825.          399.
## 6 HIST_B30         275.       987.       89.2       310.  250.  838.     1825.          399.
## 7 HIST_B40         275.       987.       89.2       310.  250.  838.     1825.          399.
## 8 HIST_Feinberg    275.       987.       89.2       310.  250.  838.     1825.          399.</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>results_mercuryemis <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="cf">for</span> (subdir <span class="cf">in</span> subdirs) {</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(subdir, <span class="st">&quot;GEOSChem.MercuryEmis.alltime_m.nc4&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  </span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="cf">next</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  </span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  merc_emiss <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(file_path)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  </span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="co"># Temps et poids mensuels</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  time_raw <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(merc_emiss, <span class="st">&quot;time&quot;</span>)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  origin_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-01-01 00:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  time <span class="ot">&lt;-</span> origin_time <span class="sc">+</span> time_raw <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">days_in_month</span>(time) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">days_in_month</span>(time))</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>  weighted_avg <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> weights)</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>  </span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>  <span class="co"># Emissions</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>  hg0land <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(merc_emiss, <span class="st">&quot;EmisHg0land&quot;</span>)  <span class="co"># [lon, lat, time]</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>  hg0soil <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(merc_emiss, <span class="st">&quot;EmisHg0soil&quot;</span>)</span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a>  <span class="co"># Calculs</span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a>  hg0land_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(hg0land, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), weighted_avg)</span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a>  hg0soil_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(hg0soil, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), weighted_avg)</span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a>  </span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a>  total_hg0land <span class="ot">&lt;-</span> <span class="fu">sum</span>(hg0land_mean) <span class="sc">*</span> s_in_yr <span class="sc">*</span> kg_Mg</span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a>  total_hg0soil <span class="ot">&lt;-</span> <span class="fu">sum</span>(hg0soil_mean) <span class="sc">*</span> s_in_yr <span class="sc">*</span> kg_Mg</span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a>  </span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a>  <span class="co"># Ajouter au tableau</span></span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a>  results_mercuryemis <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_mercuryemis, <span class="fu">tibble</span>(</span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a>    <span class="at">case =</span> <span class="fu">basename</span>(subdir),</span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a>    <span class="at">hg0land =</span> total_hg0land,</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a>    <span class="at">hg0soil =</span> total_hg0soil</span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a>  ))</span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a>  </span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a>  <span class="fu">nc_close</span>(merc_emiss)</span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a>}</span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" tabindex="-1"></a><span class="fu">print</span>(results_mercuryemis)</span></code></pre></div>
<pre><code>## # A tibble: 7 × 3
##   case      hg0land hg0soil
##   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 HIST_B10     61.8    839.
## 2 HIST_B100    52.5    839.
## 3 HIST_B150    49.3    839.
## 4 HIST_B20     60.4    839.
## 5 HIST_B200    47.0    839.
## 6 HIST_B30     59.1    839.
## 7 HIST_B40     57.9    839.</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(chem_hist, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> subdirs[<span class="fu">grepl</span>(<span class="st">&quot;HIST_&quot;</span>, <span class="fu">basename</span>(subdirs))]</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># Initialiser les résultats</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>results_drydep <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co"># Fonction de moyenne pondérée</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>weighted_avg <span class="ot">&lt;-</span> <span class="cf">function</span>(x, weights) <span class="fu">sum</span>(x <span class="sc">*</span> weights)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co"># Boucle sur les cas</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="cf">for</span> (subdir <span class="cf">in</span> subdirs) {</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(subdir, <span class="st">&quot;GEOSChem.DryDep.2015_m.nc4&quot;</span>)</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="cf">next</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>  </span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>  drydep_nc <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(file_path)</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>  </span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>  <span class="co"># Temps</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>  time_raw <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(drydep_nc, <span class="st">&quot;time&quot;</span>)</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>  origin_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-01-01 00:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>  time <span class="ot">&lt;-</span> origin_time <span class="sc">+</span> time_raw <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>  days_in_months <span class="ot">&lt;-</span> <span class="fu">days_in_month</span>(time)</span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> days_in_months <span class="sc">/</span> <span class="fu">sum</span>(days_in_months)</span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>  </span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a>  <span class="co"># Extraction et traitement des 3 espèces</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a>  get_drydep_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(varname) {</span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(drydep_nc, varname)</span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">apply</span>(var, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), weighted_avg, <span class="at">weights =</span> weights)</span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a>    var <span class="ot">&lt;-</span> var <span class="sc">*</span> unit_conv_dd <span class="sc">*</span> kg_Mg</span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a>    <span class="fu">sum</span>(var, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a>  }</span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>  </span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>  DryDep_Hg0_hist <span class="ot">&lt;-</span> <span class="fu">get_drydep_sum</span>(<span class="st">&quot;DryDep_Hg0&quot;</span>)</span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a>  DryDep_Hg2_hist <span class="ot">&lt;-</span> <span class="fu">get_drydep_sum</span>(<span class="st">&quot;DryDep_Hg2&quot;</span>)</span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a>  DryDep_HgP_hist <span class="ot">&lt;-</span> <span class="fu">get_drydep_sum</span>(<span class="st">&quot;DryDep_HgP&quot;</span>)</span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a>  </span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a>  <span class="co"># Stocker</span></span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a>  results_drydep <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_drydep, <span class="fu">tibble</span>(</span>
<span id="cb26-38"><a href="#cb26-38" tabindex="-1"></a>    <span class="at">case =</span> <span class="fu">basename</span>(subdir),</span>
<span id="cb26-39"><a href="#cb26-39" tabindex="-1"></a>    <span class="at">drydep_Hg0_tonnes =</span> DryDep_Hg0_hist,</span>
<span id="cb26-40"><a href="#cb26-40" tabindex="-1"></a>    <span class="at">drydep_Hg2_tonnes =</span> DryDep_Hg2_hist,</span>
<span id="cb26-41"><a href="#cb26-41" tabindex="-1"></a>    <span class="at">drydep_HgP_tonnes =</span> DryDep_HgP_hist</span>
<span id="cb26-42"><a href="#cb26-42" tabindex="-1"></a>  ))</span>
<span id="cb26-43"><a href="#cb26-43" tabindex="-1"></a>  </span>
<span id="cb26-44"><a href="#cb26-44" tabindex="-1"></a>  <span class="fu">nc_close</span>(drydep_nc)</span>
<span id="cb26-45"><a href="#cb26-45" tabindex="-1"></a>}</span>
<span id="cb26-46"><a href="#cb26-46" tabindex="-1"></a></span>
<span id="cb26-47"><a href="#cb26-47" tabindex="-1"></a><span class="co"># Afficher les résultats</span></span>
<span id="cb26-48"><a href="#cb26-48" tabindex="-1"></a><span class="fu">print</span>(results_drydep)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 4
##   case          drydep_Hg0_tonnes drydep_Hg2_tonnes drydep_HgP_tonnes
##   &lt;chr&gt;                     &lt;dbl&gt;             &lt;dbl&gt;             &lt;dbl&gt;
## 1 HIST_B10                   2.17             0.801           0.0649 
## 2 HIST_B100                  2.24             0.747           0.0677 
## 3 HIST_B150                  2.26             0.727           0.0688 
## 4 HIST_B20                   2.18             0.793           0.0653 
## 5 HIST_B200                  2.28             0.712           0.0696 
## 6 HIST_B30                   2.19             0.785           0.0657 
## 7 HIST_B40                   2.20             0.779           0.0661 
## 8 HIST_Feinberg              2.36             0.709           0.00999
## 9 HIST_V3                    2.16             0.810           0.0645</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Sous-dossiers HIST_*</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(chem_hist, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>subdirs <span class="ot">&lt;-</span> subdirs[<span class="fu">grepl</span>(<span class="st">&quot;HIST_&quot;</span>, <span class="fu">basename</span>(subdirs))]</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co"># Initialiser le tableau des résultats</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>results_wetloss <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co"># Fonction de moyenne pondérée</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>weighted_avg <span class="ot">&lt;-</span> <span class="cf">function</span>(x, weights) <span class="fu">sum</span>(x <span class="sc">*</span> weights)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co"># Boucle sur les cas</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="cf">for</span> (subdir <span class="cf">in</span> subdirs) {</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(subdir, <span class="st">&quot;GEOSChem.WetLossTot_HgSum.2015_m.nc4&quot;</span>)</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="cf">next</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>  </span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>  wetloss_nc <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(file_path)</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>  </span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>  <span class="co"># Temps</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>  time_raw <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(wetloss_nc, <span class="st">&quot;time&quot;</span>)</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>  origin_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-01-01 00:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>  time <span class="ot">&lt;-</span> origin_time <span class="sc">+</span> time_raw <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>  days_in_months <span class="ot">&lt;-</span> <span class="fu">days_in_month</span>(time)</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> days_in_months <span class="sc">/</span> <span class="fu">sum</span>(days_in_months)</span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>  </span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>  <span class="co"># Extraction et traitement</span></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a>  wetloss_array <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(wetloss_nc, <span class="st">&quot;WetLossTot_HgSum&quot;</span>)</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a>  wetloss_array <span class="ot">&lt;-</span> <span class="fu">apply</span>(wetloss_array, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), weighted_avg, <span class="at">weights =</span> weights)</span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a>  wetloss_total_tonnes <span class="ot">&lt;-</span> <span class="fu">sum</span>(wetloss_array <span class="sc">*</span> s_in_yr <span class="sc">*</span> kg_Mg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a>  </span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a>  <span class="co"># Stocker</span></span>
<span id="cb28-31"><a href="#cb28-31" tabindex="-1"></a>  results_wetloss <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_wetloss, <span class="fu">tibble</span>(</span>
<span id="cb28-32"><a href="#cb28-32" tabindex="-1"></a>    <span class="at">case =</span> <span class="fu">basename</span>(subdir),</span>
<span id="cb28-33"><a href="#cb28-33" tabindex="-1"></a>    <span class="at">wetloss_Hg_total_tonnes =</span> wetloss_total_tonnes</span>
<span id="cb28-34"><a href="#cb28-34" tabindex="-1"></a>  ))</span>
<span id="cb28-35"><a href="#cb28-35" tabindex="-1"></a>  </span>
<span id="cb28-36"><a href="#cb28-36" tabindex="-1"></a>  <span class="fu">nc_close</span>(wetloss_nc)</span>
<span id="cb28-37"><a href="#cb28-37" tabindex="-1"></a>}</span>
<span id="cb28-38"><a href="#cb28-38" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" tabindex="-1"></a><span class="co"># Afficher les résultats</span></span>
<span id="cb28-40"><a href="#cb28-40" tabindex="-1"></a><span class="fu">print</span>(results_wetloss)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 2
##   case          wetloss_Hg_total_tonnes
##   &lt;chr&gt;                           &lt;dbl&gt;
## 1 HIST_B10                        1818.
## 2 HIST_B100                       1724.
## 3 HIST_B150                       1694.
## 4 HIST_B20                        1803.
## 5 HIST_B200                       1672.
## 6 HIST_B30                        1790.
## 7 HIST_B40                        1778.
## 8 HIST_Feinberg                   2234.
## 9 HIST_V3                         1835.</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/colom/Desktop/STAGE/data/clean_mod_data/14_3_1/HIST_B10/GEOSChem.WetLossTot_HgSum.2015_m.nc4&quot;</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>wetloss_nc <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(file_path)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co"># Extraire le temps</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>time_raw <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(wetloss_nc, <span class="st">&quot;time&quot;</span>)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>origin_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-01-01 00:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>time <span class="ot">&lt;-</span> origin_time <span class="sc">+</span> time_raw <span class="sc">*</span> <span class="dv">60</span>  <span class="co"># en secondes</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>days_in_months <span class="ot">&lt;-</span> <span class="fu">days_in_month</span>(time)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>weights <span class="ot">&lt;-</span> days_in_months <span class="sc">/</span> <span class="fu">sum</span>(days_in_months)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co"># Extraire la variable et appliquer la moyenne pondérée sur le temps</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>wetloss_array <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(wetloss_nc, <span class="st">&quot;WetLossTot_HgSum&quot;</span>)</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>wetloss_array_avg <span class="ot">&lt;-</span> <span class="fu">apply</span>(wetloss_array, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> weights))</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co"># Calcul total en tonnes</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>wetloss_total_tonnes <span class="ot">&lt;-</span> <span class="fu">sum</span>(wetloss_array_avg <span class="sc">*</span> s_in_yr <span class="sc">*</span> kg_Mg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a><span class="co"># Fermer le fichier NetCDF</span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a><span class="fu">nc_close</span>(wetloss_nc)</span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a><span class="co"># Afficher le résultat</span></span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a><span class="fu">print</span>(wetloss_total_tonnes)</span></code></pre></div>
<pre><code>## [1] 1817.926</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Fusionner les tables selon la colonne commune &quot;case&quot;</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>results_all <span class="ot">&lt;-</span> results_wetloss <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  <span class="fu">full_join</span>(results_drydep, <span class="at">by =</span> <span class="st">&quot;case&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">full_join</span>(results_mercuryemis, <span class="at">by =</span> <span class="st">&quot;case&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="fu">full_join</span>(results, <span class="at">by =</span> <span class="st">&quot;case&quot;</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co"># Écrire dans un fichier Excel</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="fu">write_xlsx</span>(results_all, <span class="st">&quot;C:/Users/colom/Desktop/STAGE/data/clean_mod_data/14_3_1/resultats_mercury.xlsx&quot;</span>)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co"># Fusionner les tables selon la colonne commune &quot;case&quot;</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>results_mass_all <span class="ot">&lt;-</span> results_mass_Hg_total  <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>  <span class="fu">full_join</span>(results_mass_Hg0, <span class="at">by =</span> <span class="st">&quot;case&quot;</span>)</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co"># Écrire dans un fichier Excel</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a><span class="fu">write_xlsx</span>(results_mass_all, <span class="st">&quot;C:/Users/colom/Desktop/STAGE/data/clean_mod_data/14_3_1/resultats_mass_mercury.xlsx&quot;</span>)</span></code></pre></div>

</body>
</html>
